# Модуль сбора товаров со страницы категорий поставщика hb.co.il через вебдрайвер

## Обзор

Модуль `category.py` предназначен для сбора информации о товарах с сайта hb.co.il. Он предоставляет функции для:

- Получения списка категорий со страниц продавца.
- Получения списка товаров со страницы категории.
- Обработки страниц товаров и передачи данных в класс `Product`.

## Подробней

- **Сценарий работы модуля**:
    - Модуль извлекает список категорий с сайта, используя функцию `get_list_categories_from_site()`.
    - Затем, для каждой категории, собирается список товаров с помощью функции `get_list_products_in_category()`.
    - Для каждого товара из списка вызывается функция `grab_product_page()`, которая обрабатывает информацию о товаре и передает ее в класс `Product`.
- **Особенности**:
    - Модуль использует вебдрайвер для взаимодействия с сайтом, в частности, использует объект `driver` из модуля `src.webdriver.driver`.
    - В качестве источника данных используются локаторы, заданные в файле конфигурации (`s.locators`). 
    - Модуль использует `logger` для записи сообщений в журнал.

## Классы

**В данном модуле нет классов.**

## Функции

### `get_list_products_in_category`

**Назначение**: Извлекает список URL товаров со страницы категории.

**Параметры**:

- `s` (`Supplier`): Объект поставщика, содержащий информацию о сайте и локаторах.

**Возвращает**:

- `list` или `None`: Список URL товаров или `None`, если товаров не найдено.

**Вызывает исключения**:

- `Exception`: Если возникает ошибка во время работы функции.

**Пример**:

```python
# Получаем список товаров из категории
products = get_list_products_in_category(supplier_object)
if products:
    print(f"Найдено {len(products)} товаров в категории.")
else:
    print(f"Товаров в категории не найдено.")
```

**Как работает функция**:

1. Функция получает объект `Supplier` в качестве аргумента.
2. Извлекает локаторы для категории и товара из `s.locators`.
3. Инициализирует драйвер `d: Driver = s.driver` и ждет 1 секунду. 
4. Выполняет замыкание баннера, используя `s.locators['product']['close_banner']`. 
5. Выполняет прокрутку страницы, чтобы все элементы были видны. 
6. Получает список ссылок на товары из `l['product_links']`.
7. Если товаров нет - функция возвращает `None`. 
8. Далее цикл. 
9. Функция  `paginator()` проверяет наличие кнопки перехода на следующую страницу. 
10. Если кнопка есть - функция `paginator()` выполняет переход на следующую страницу. 
11. Если переход на следующую страницу невозможен - цикл завершается.
12. Все ссылки на товары помещаются в `list_products_in_category`.
13. Функция возвращает `list_products_in_category`.

### `paginator`

**Назначение**: Проверяет наличие кнопки перехода на следующую страницу и выполняет переход на неё.

**Параметры**:

- `d` (`Driver`): Объект вебдрайвера.
- `locator` (`dict`): Локатор кнопки перехода на следующую страницу.
- `list_products_in_category` (`list`): Список ссылок на товары.

**Возвращает**:

- `True` если кнопка есть и выполнен переход, `False` иначе.

**Пример**:

```python
# Проверяем наличие кнопки перехода на следующую страницу
next_page = paginator(driver, locator, product_links)
if next_page:
    print("Переход на следующую страницу")
else:
    print("Переход на следующую страницу невозможен")
```

**Как работает функция**:

1. Функция получает объект `Driver` `d`, локатор кнопки перехода на следующую страницу `locator` и список ссылок на товары `list_products_in_category`.
2. Выполняет `d.execute_locator` с локатором кнопки `locator['pagination']['<-\']`. 
3. Если кнопка не найдена - функция возвращает `None`.
4. Если кнопка есть, функция возвращает `True`. 

### `get_list_categories_from_site`

**Назначение**: Собирает список актуальных категорий с сайта.

**Параметры**:

- `s` (`Supplier`): Объект поставщика, содержащий информацию о сайте и локаторах.

**Возвращает**:

- `list`: Список категорий, собранных с сайта.

**Вызывает исключения**:

- `Exception`: Если возникает ошибка во время работы функции.

**Пример**:

```python
# Собираем список категорий
categories = get_list_categories_from_site(supplier_object)
print(f"Найдено {len(categories)} категорий.")
```

**Как работает функция**:

1. Функция получает объект `Supplier` в качестве аргумента. 
2. Функция извлекает список категорий с сайта и возвращает его. 


## Параметры класса
В данном модуле нет параметров класса.

## Примеры

```python
# Пример использования функций модуля
from src.suppliers.hb.category import get_list_products_in_category, get_list_categories_from_site, paginator
from src.suppliers.suppliers_list import hb
from src.suppliers.suppliers_list.hb.category import get_list_products_in_category

# Инициализация объекта Supplier
supplier_object = hb.Hb()
# Получение списка категорий
categories = get_list_categories_from_site(supplier_object)
print(f"Найдено {len(categories)} категорий.")

# Перебор каждой категории
for category in categories:
    print(f"Обработка категории: {category}")
    supplier_object.current_scenario['name'] = category
    # Получение списка товаров в категории
    products = get_list_products_in_category(supplier_object)
    if products:
        print(f"Найдено {len(products)} товаров в категории.")
        # Перебор товаров и дальнейшая обработка
        for product_url in products:
            print(f"Обработка товара: {product_url}")
            # Вызов функции grab_product_page(product_url) для сбора информации о товаре
            # ...
    else:
        print(f"Товаров в категории не найдено.")