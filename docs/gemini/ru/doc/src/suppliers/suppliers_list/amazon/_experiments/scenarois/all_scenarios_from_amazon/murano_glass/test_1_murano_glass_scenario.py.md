# Тестовый сценарий для товара из Murano Glass на Amazon

## Обзор

Этот файл представляет собой тестовый сценарий для извлечения информации о товаре из Murano Glass на Amazon. Сценарий  запускается для проверки работоспособности модуля `src.suppliers.amazon` и  выполняет следующие действия:

1. **Загрузка страницы**: 
    - Извлекает URL товара из `s.current_scenario['url']`.
    - Открывает URL с помощью `d.get_url()`.
2. **Извлечение информации**:
    - Извлекает  `ASIN` товара с помощью `_(l['ASIN'])`. 
    - Проверяет наличие товара в базе данных PrestaShop с помощью `Product.check_if_product_in_presta_db()`.
    - Если товар найден в базе данных, то обновляет информацию о товаре, включая загрузку изображения.
    - Если товар не найден, то извлекает информацию о товаре с помощью `Product.grab_product_page()` и создает новый товар в базе данных.
3. **Обработка информации**:
    - Форматирует и очищает информацию о товаре с помощью `StringNormalizer`, `StringFormatter`.
    - Форматирует информацию о товаре в соответствии с форматом PrestaShop.
4. **Загрузка товара**:
    - Загружает информацию о товаре в базу данных PrestaShop с помощью `PrestaProduct.add()`.

## Подробей

Код сценария использует объект `s` (класс `Supplier`) для получения информации о поставщике и текущем сценарии. 
Он использует объект `d` (класс `Driver`) для работы с веб-браузером и выполняет действия по извлечению информации с помощью локаторов из объекта `l` (класс `Locator`).
Код также использует функции из модуля `header` для работы с продуктами, поставщиками, PrestaShop API и загрузкой изображений.

## Классы

### `Supplier` 

**Описание**: Класс, представляющий поставщика товаров.
**Наследует**: 
**Атрибуты**:
    - `supplier_id` (str): Идентификатор поставщика.
    - `locators` (dict): Словарь локаторов для элементов страницы поставщика.
    - `driver` (Driver): Объект драйвера веб-браузера.
    - `current_scenario` (dict): Словарь, содержащий информацию о текущем сценарии.

**Методы**:
    - `get_url(url: str) -> None`: Открывает URL-адрес в браузере. 
    - `get_product_data(product_url: str) -> dict`: Извлекает информацию о продукте с указанного URL-адреса.


## Функции

### `start_supplier(supplier_prefix: str) -> Supplier`

**Назначение**: Создает объект `Supplier` для заданного поставщика.

**Параметры**:
    - `supplier_prefix` (str): Префикс названия поставщика.

**Возвращает**:
    - `Supplier`: Объект `Supplier`, который содержит информацию о поставщике.

**Как работает**: 
    - Создает объект `Supplier`.
    - Задает атрибуты `supplier_id` и `locators` на основе значения `supplier_prefix`.
    - Возвращает объект `Supplier`.

### `Product.check_if_product_in_presta_db(product_reference: str) -> bool | int`:

**Назначение**: Проверяет, существует ли товар в базе данных PrestaShop.

**Параметры**:
    - `product_reference` (str): Ссылка товара.

**Возвращает**:
    - `bool | int`: `False`, если товар не найден, или ID товара, если товар найден.

**Как работает**: 
    - Выполняет запрос к API PrestaShop для поиска товара по `product_reference`.
    - Возвращает `False`, если товар не найден, или ID товара, если товар найден.

### `Product.upload_image2presta(image_url: str, product_id: int) -> None`:

**Назначение**: Загружает изображение товара в PrestaShop.

**Параметры**:
    - `image_url` (str): URL изображения товара.
    - `product_id` (int): ID товара.

**Возвращает**:
    - `None`.

**Как работает**: 
    - Загружает изображение с помощью `upload_image()`.
    - Выполняет запрос к API PrestaShop для загрузки изображения товара по `product_id`.

### `Product.grab_product_page(s: Supplier) -> ProductFields`:

**Назначение**: Извлекает информацию о товаре с текущей страницы.

**Параметры**:
    - `s` (Supplier): Объект `Supplier`, который содержит информацию о поставщике.

**Возвращает**:
    - `ProductFields`: Объект `ProductFields`, который содержит информацию о товаре.

**Как работает**: 
    - Извлекает информацию о товаре с помощью `_(l['...'])` для каждого элемента на странице.
    - Заполняет объект `ProductFields` извлеченной информацией.
    - Возвращает объект `ProductFields`.


## Примеры

```python
# Создание объекта `Supplier`
s = start_supplier('amazon')

# Загрузка страницы товара
d.get_url(s.current_scenario['url'])

# Извлечение ASIN товара
ASIN = _(l['ASIN'])

# Проверка наличия товара в базе данных PrestaShop
product_id = Product.check_if_product_in_presta_db(product_reference)

# Обновление информации о товаре (если товар найден)
Product.upload_image2presta(image_url = default_image_url, product_id = product_id)

# Извлечение информации о товаре (если товар не найден)
product_fields = Product.grab_product_page(s)

# Создание нового товара в базе данных PrestaShop
product_dict = { 'product': dict(product_fields.fields) }
pprint(PrestaProduct.add(product_dict)) 
```

```python
# Создание инстанса драйвера (пример с Chrome)
driver = Drivewr(Chrome)