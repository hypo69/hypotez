# Генератор отчётов для Мехиронов Казаринова

## Обзор

Модуль `src.endpoints.kazarinov.react.pricelist_generator` содержит класс `ReportGenerator`, который используется для генерации HTML- и PDF-отчётов на основе данных из JSON-файлов. Отчёты создаются для Мехиронов Казаринова и используются для предоставления информации о продуктах.

## Подробности

Модуль `src.endpoints.kazarinov.react.pricelist_generator` -  это часть API, которое генерирует отчёты для Мехиронов Казаринова. Он использует данные из JSON-файлов, которые хранятся в каталоге `external_storage/kazarinov/mexironim`. 

### Класс `ReportGenerator`

#### Описание:

Класс `ReportGenerator` отвечает за генерацию HTML- и PDF-отчётов на основе данных из JSON. Он использует Jinja2 для рендеринга HTML-шаблонов и pdfkit для преобразования HTML в PDF.

####  Атрибуты:

- `env` (jinja2.Environment): Объект Jinja2 для рендеринга шаблонов.

#### Методы:

##### `generate_html(self, data: dict, lang: str) -> str`:

- **Назначение**: Генерирует HTML-контент на основе шаблона и данных.
- **Параметры**:
    - `data` (dict): Данные для рендеринга шаблона.
    - `lang` (str): Язык отчёта.
- **Возвращает**:
    - `str`: HTML-контент.
- **Как работает функция**:
    - Метод `generate_html` использует Jinja2 для рендеринга HTML-шаблона.
    - Он выбирает шаблон в зависимости от языка ( `template_table_he.html` для иврита, `template_table_ru.html` для русского).
    - Шаблон загружается из каталога `templates` в `gs.path.endpoints/kazarinov/pricelist_generator/templates`.
    - Данные передаются в шаблон с помощью `template.render(**data)`.

##### `create_report(self, data: dict, lang: str, html_file: str | Path, pdf_file: str | Path) -> bool`:

- **Назначение**: Выполняет полный цикл генерации отчёта:
    - Генерирует HTML.
    - Сохраняет HTML в файл.
    - Преобразует HTML в PDF.
- **Параметры**:
    - `data` (dict): Данные для рендеринга отчёта.
    - `lang` (str): Язык отчёта.
    - `html_file` (str | Path): Путь к файлу для сохранения HTML.
    - `pdf_file` (str | Path): Путь к файлу для сохранения PDF.
- **Возвращает**:
    - `bool`: `True`, если генерация отчёта прошла успешно, `False` в противном случае.
- **Как работает функция**:
    - Метод `create_report` сначала генерирует HTML с помощью `self.generate_html`.
    - Затем он записывает HTML-контент в файл с помощью `Path(html_file).write_text`.
    - После этого он создаёт объект `PDFUtils` и использует его для преобразования HTML в PDF с помощью `pdf.save_pdf_pdfkit`.
    - Если преобразование прошло успешно, функция возвращает `True`, в противном случае - `False`.

### `main(mexiron: str, lang: str) -> bool`:

- **Назначение**: Выполняет генерацию отчёта на основе данных из JSON-файла.
- **Параметры**:
    - `mexiron` (str): Идентификатор Мехирона.
    - `lang` (str): Язык отчёта.
- **Как работает функция**:
    - Сначала функция получает путь к JSON-файлу, соответствующему Мехирону и языку.
    - Затем она считывает данные из JSON-файла с помощью `j_loads`.
    - После этого она создаёт объект `ReportGenerator` и запускает метод `create_report` с данными, языком и путями к файлам для HTML и PDF.

## Примеры

```python
# Генерация отчёта для Мехирона "24_12_01_03_18_24_269" на русском языке
mexiron: str = '24_12_01_03_18_24_269'
lang: str = 'ru'
main(mexiron, lang)
```

```python
# Генерация отчёта для Мехирона "24_12_01_03_18_24_269" на иврите
mexiron: str = '24_12_01_03_18_24_269'
lang: str = 'he'
main(mexiron, lang)
```

## Внутренние функции:

- В данном коде нет внутренних функций.

## Системные инструкции:

- Всегда используй модуль `logger` из `src.logger.logger`.
- Используй `j_loads` или `j_loads_ns` для чтения JSON-файлов.
- Вместо `open` и `json.load` используй `j_loads`.
- Для веб-драйвера используй `Driver`, `Chrome`, `Firefox`, `Playwright`.
- Основная команда для работы с веб-драйвером: `driver.execute_locator(l:dict)`.
- Все комментарии и docstring должны быть на русском языке в формате UTF-8.
- Если в оригинальном коде текст написан на английском - переводи его на русский.

## Твое поведение при анализе кода:

- В коде ты можешь встретить выражение между `<` `>`. Например: <инструкция для модели gemini:Загрузка описаний продуктов в PrestaShop.>, <далее, если есть>. Это заготовки, куда ты вставляешь релевантное значение.
- Всегда смотри системную инструкцию для обработки кода проекта `hypotez`.
- Анализируй расположение файла в проекте. Это поможет понять его назначение и взаимосвязь с другими файлами. Расположение файла ты найдешь в самой превой строке кода, начинающейся с `## \\file /...`.
- Запоминай предоставленный код и анализируй его связь с другими частями проекта.
- В этой инструкции не надо предлагать улучшение кода. Четко следуй пункту 5. **Пример файла** при составлении ответа.