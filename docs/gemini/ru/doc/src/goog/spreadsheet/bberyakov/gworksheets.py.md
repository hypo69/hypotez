# Модуль GWorksheet

## Обзор

Модуль `src.goog.spreadsheet.bberyakov.gworksheets` предоставляет класс `GWorksheet`, который упрощает работу с таблицами Google Sheets. 

## Подробнее

`GWorksheet` наследует от `Worksheet`, предоставляя набор функций для работы с таблицами, включая создание, чтение, запись и форматирование данных. 

Этот модуль предназначен для удобного взаимодействия с Google Sheets в контексте проекта `hypotez`.

## Классы

### `GWorksheet`

**Описание**: Класс для работы с таблицами Google Sheets.
**Наследует**:
    - `Worksheet`: Базовый класс для работы с таблицами в Google Sheets.
**Атрибуты**:
    - `sh`: Объект `Spreadsheet` (ссылка на Google Spreadsheet).
    - `ws`: Объект `Worksheet` (ссылка на Google Worksheet).
    - `render`: Объект `GSRender` для рендеринга данных в таблицу.

**Принцип работы**: 

    `GWorksheet` обеспечивает удобный интерфейс для работы с Google Sheets. 
    Он использует `Spreadsheet` и `Worksheet` для доступа к данным, а также `GSRender` для форматирования и записи данных.

**Методы**:

#### `__init__(self, sh, ws_title: str = 'new', rows = None, cols = None, direcion = 'rtl', wipe_if_exist: bool = True, *args, **kwargs) -> None`

**Описание**: Инициализирует объект `GWorksheet`.

**Параметры**:
    - `self`: Объект класса `GWorksheet`.
    - `sh`: Объект `Spreadsheet`, представляющий Google Spreadsheet.
    - `ws_title`: (str, по умолчанию 'new') Название таблицы (worksheet).
    - `rows`: (int, по умолчанию None) Количество строк.
    - `cols`: (int, по умолчанию None) Количество колонок.
    - `direction`: (str, по умолчанию 'rtl') Направление текста в ячейках.
    - `wipe_if_exist`: (bool, по умолчанию True) Очистить таблицу от старых данных, если таблица с таким именем уже существует.
    - `*args`: Дополнительные аргументы.
    - `**kwargs`: Дополнительные аргументы в формате "ключ-значение".

**Возвращает**:
    - `None`

**Как работает**:
    - Получает ссылку на `Spreadsheet`.
    - Если `ws_title` равен `new`, то создает новую таблицу.
    - Если `ws_title` не равен `new`, то открывает существующую таблицу. 
    - Очищает таблицу от старых данных, если `wipe_if_exist` равен `True`.
    - Устанавливает направление текста в таблице.

#### `get(self, sh, ws_title: str = 'new', rows: int = 100, cols: int = 100, direction: str = 'rtl', wipe_if_exist: bool = True)`

**Описание**: Создает новую таблицу или открывает существующую.

**Параметры**:
    - `self`: Объект класса `GWorksheet`.
    - `sh`: Объект `Spreadsheet`, представляющий Google Spreadsheet.
    - `ws_title`: (str, по умолчанию 'new') Название таблицы (worksheet).
    - `rows`: (int, по умолчанию 100) Количество строк.
    - `cols`: (int, по умолчанию 100) Количество колонок.
    - `direction`: (str, по умолчанию 'rtl') Направление текста в ячейках.
    - `wipe_if_exist`: (bool, по умолчанию True) Очистить таблицу от старых данных, если таблица с таким именем уже существует.

**Возвращает**:
    - `None`

**Как работает**:
    - Создает новую таблицу, если `ws_title` равен 'new'.
    - Открывает существующую таблицу, если `ws_title` не равен 'new'.
    - Очищает таблицу от старых данных, если `wipe_if_exist` равен `True`.
    - Устанавливает направление текста в таблице.


#### `header(self, world_title: str, range: str = 'A1:Z1', merge_type: str(\'MERGE_ALL\') | str(\'MERGE_COLUMNS\') | str(\'MERGE_ROWS\') = 'MERGE_ALL') -> None`

**Описание**: Добавляет заголовок в таблицу.

**Параметры**:
    - `self`: Объект класса `GWorksheet`.
    - `world_title`: (str) Текст заголовка.
    - `range`: (str, по умолчанию 'A1:Z1') Диапазон ячеек, в котором будет размещен заголовок.
    - `merge_type`: (str, по умолчанию 'MERGE_ALL') Тип слияния ячеек (MERGE_ALL, MERGE_COLUMNS, MERGE_ROWS).

**Возвращает**:
    - `None`

**Как работает**:
    - Использует метод `render.header()` для добавления заголовка в таблицу.


#### `category(self, ws_category_title)`

**Описание**: Добавляет категорию в таблицу.

**Параметры**:
    - `self`: Объект класса `GWorksheet`.
    - `ws_category_title`: (str) Название категории.

**Возвращает**:
    - `None`

**Как работает**:
    - Использует метод `render.write_category_title()` для добавления категории в таблицу.


#### `direction(self, direction: str = 'rtl')`

**Описание**: Устанавливает направление текста в таблице.

**Параметры**:
    - `self`: Объект класса `GWorksheet`.
    - `direction`: (str, по умолчанию 'rtl') Направление текста.

**Возвращает**:
    - `None`

**Как работает**:
    - Использует метод `render.set_worksheet_direction()` для установки направления текста.

## Параметры класса

### `sh`

**Описание**: Объект `Spreadsheet` (ссылка на Google Spreadsheet).

### `ws`

**Описание**: Объект `Worksheet` (ссылка на Google Worksheet).

### `render`

**Описание**: Объект `GSRender` для рендеринга данных в таблицу.

## Примеры

```python
from src.goog.spreadsheet.bberyakov.gworksheets import GWorksheet
from src.goog.spreadsheet import Spreadsheet

# Создание объекта Spreadsheet
sh = Spreadsheet('your_spreadsheet_id')

# Создание объекта GWorksheet
ws = GWorksheet(sh, ws_title='MyWorksheet')

# Добавление заголовка
ws.header(world_title='Заголовок таблицы')

# Добавление категории
ws.category('Категория 1')

# Запись данных в таблицу
ws.ws.update_acell('A2', 'Данные в ячейке A2')

# Установка направления текста
ws.direction('rtl')

# Сохранение изменений
sh.gsh.save()
```

## Твое поведение при анализе кода:

- В этой инструкции не надо предлагать улучшение кода. Четко следуй пункту 5. **Пример файла** при составлении ответа.
- Внутри кода ты можешь встретить выражение между `<` `>`. Например: `<инструкция для модели gemini:Загрузка описаний товаров в PrestaShop.>, <далее, если есть>. Это заготовки, куда ты вставляешь релевантное значение.
- Всегда смотри системную инструкцию для обработки кода проекта `hypotez`.
- Анализируй расположение файла в проекте. Это поможет понять его назначение и взаимосвязь с другими файлами. Расположение файла ты найдешь в самой первой строке кода, начинающейся с `## \\file /...`.
- Запоминай предоставленный код и анализируй его связь с другими частями проекта.