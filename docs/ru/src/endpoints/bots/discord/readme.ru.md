# Документация модуля `src.endpoints.bots.discord`

## Обзор

Этот модуль содержит документацию по Discord-боту, который выполняет различные функции, такие как управление моделью машинного обучения, обработка аудио и взаимодействие с пользователями в текстовых и голосовых каналах Discord.

## Подробней

Discord-бот предоставляет интерактивное взаимодействие с пользователями, включая обработку голосовых команд, обучение и тестирование модели машинного обучения, а также предоставление инструкций и обратной связи. Для работы бота используются различные модули и библиотеки, такие как `discord.py`, `speech_recognition`, `gtts` и другие.

## Содержание

- [Основные функции и команды бота](#основные-функции-и-команды-бота)
- [Основные модули и библиотеки](#основные-модули-и-библиотеки)
- [Запуск бота](#запуск-бота)

## Основные функции и команды бота

1.  **Инициализация бота:**
    *   Бот инициализируется с префиксом команд `!` и включает необходимые интенты (разрешения на доступ к определенным событиям Discord).

2.  **Команды:**
    *   `!hi`: Отправляет приветственное сообщение.
    *   `!join`: Подключает бота к голосовому каналу, в котором находится пользователь.
    *   `!leave`: Отключает бота от голосового канала.
    *   `!train`: Обучает модель на предоставленных данных, которые можно передать в виде файла или текста.
    *   `!test`: Тестирует модель на предоставленных данных.
    *   `!archive`: Архивирует файлы в указанной директории.
    *   `!select_dataset`: Выбирает датасет для обучения модели.
    *   `!instruction`: Отправляет инструкции из внешнего файла.
    *   `!correct`: Позволяет пользователю исправить предыдущее сообщение бота.
    *   `!feedback`: Позволяет пользователю отправить обратную связь о работе бота.
    *   `!getfile`: Отправляет файл из указанного пути.

3.  **Обработка сообщений:**
    *   Бот обрабатывает входящие сообщения, игнорируя свои собственные сообщения.
    *   Если пользователь отправляет аудиофайл, бот распознает речь в аудио и отправляет текст в ответ.
    *   Если пользователь находится в голосовом канале, бот преобразует текст в речь и воспроизводит его в голосовом канале.

4.  **Распознавание речи:**
    *   Функция `recognizer` скачивает аудиофайл, конвертирует его в формат WAV и распознает речь с помощью Google Speech Recognition.

5.  **Текст в речь:**
    *   Функция `text_to_speech_and_play` преобразует текст в речь с помощью библиотеки `gTTS` и воспроизводит его в голосовом канале.

6.  **Логирование:**
    *   Используется модуль `logger` для логирования событий и ошибок.

## Основные модули и библиотеки

*   `discord.py`: Основная библиотека для создания Discord-ботов.
*   `speech_recognition`: Для распознавания речи.
*   `pydub`: Для конвертации аудиофайлов.
*   `gtts`: Для преобразования текста в речь.
*   `requests`: Для скачивания файлов.
*   `pathlib`: Для работы с путями файлов.
*   `tempfile`: Для создания временных файлов.
*   `asyncio`: Для асинхронного выполнения задач.

## Запуск бота

Бот запускается с использованием токена, который хранится в переменной `gs.credentials.discord.bot_token`.